<?php

$url = "{{requestUrl}}";

{% if request.parameters.size > 0 -%}
$parameters = array(
    // Request parameters
{% for parameter in request.parameters -%}
    '{{parameter.name}}' => '{{parameter.value}}',
{% endfor -%}
);
$url .= $parameters;
{% endif -%}

$curl = curl_init($url);

curl_setopt($curl, CURLOPT_CUSTOMREQUEST, "{{method}}");
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);

{% if request.meaningfulHeaders.size > 0 -%}
// Request headers
$headers = array(
{%- for header in request.meaningfulHeaders %}
    '{{header.name}}: {{header.displayedValue}}',
{%- endfor -%});
curl_setopt($curl, CURLOPT_HTTPHEADER, $headers);
{%- endif %}
{% if request.body != blank and request.bodyFormat == "raw" %}
// Request body
$request_body = '{{request.body}}';
curl_setopt($curl, CURLOPT_POSTFIELDS, $request_body);
{% endif %}
$resp = curl_exec($curl);
curl_close($curl);
var_dump($resp);
?>